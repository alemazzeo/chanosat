import numpy as np
import matplotlib.pyplot as plt
from matplotlib import patches

s1 = ([10000, 21.0, 0.0, -16.50, 1071.34, 819.20],
      [10000, 21.0, 0.0, -14.50, 1087.98, 845.75],
      [10000, 21.0, 0.0, -12.00, 1108.61, 878.19],
      [10000, 21.0, 0.0, -9.50, 1128.99, 909.93],
      [1000, 21.0, 0.0, -6.50, 1152.58, 946.98],
      [1000, 21.0, 0.0, -4.00, 1169.09, 972.47],
      [1000, 21.0, 0.0, 6.50, 1245.60, 1094.37],
      [1000, 21.0, 0.0, 9.00, 1266.11, 1126.36],
      [1000, 21.0, 0.0, 11.50, 1287.93, 1161.00],
      [1000, 21.0, 0.0, 14.00, 1312.31, 1200.19],
      [1000, 21.0, 0.0, 16.00, 1335.57, 1236.92],
      [1000, 21.0, 0.0, 17.50, 1351.30, 1261.09])

s2 = ([10000, 21.0, -20.0, -15.00, 1227.82, 800.13],
      [10000, 21.0, -20.0, -10.00, 1245.14, 878.05],
      [1000, 21.0, -20.0, -5.00, 1260.04, 943.75],
      [100, 21.0, -20.0, 0.00, 1274.59, 1008.52],
      [10000, 21.0, -20.0, 10.00, 1304.83, 1147.97],
      [10000, 21.0, -20.0, 15.00, 1324.95, 1239.10])

s3 = ([10000, 21.0, -10.0, -20.00, 1145.26, 781.95],
      [10000, 21.0, -10.0, -10.00, 1185.26, 886.24],
      [10, 21.0, -10.0, 0.00, 1235.64, 1010.36],
      [100, 21.0, -10.0, 5.00, 1262.82, 1075.55],
      [1000, 21.0, -10.0, 10.00, 1289.60, 1142.71],
      [10000, 21.0, -10.0, 15.00, 1324.38, 1228.86])

s4 = ([10000, 21.0, 10.0, -15.00, 1018.56, 876.56],
      [10000, 21.0, 10.0, -10.00, 1072.19, 935.42],
      [10, 25.0, 10.0, 0.00, 1136.31, 1006.90],
      [1000, 21.0, 10.0, 10.00, 1258.92, 1139.98],
      [10000, 21.0, 10.0, 15.00, 1321.80, 1209.04])

s5 = ([10000, 21.0, 20.0, -15.00, 961.83, 925.10],
      [1000, 21.0, 20.0, -10.00, 1025.07, 973.66],
      [1000, 21.0, 20.0, -5.00, 1078.17, 1015.19],
      [10, 21.0, 20.0, 0.00, 1135.46, 1054.64],
      [100, 21.0, 20.0, 5.00, 1186.70, 1098.75],
      [1000, 21.0, 20.0, 10.00, 1243.94, 1143.47],
      [1000, 21.0, 20.0, 15.00, 1318.03, 1200.75])


plt.ion()
fig, ax = plt.subplots(subplot_kw={'aspect': 'equal'})

data = list()

for serie in [s1, s2, s3, s4, s5]:
    xs = list()
    ys = list()
    for e, s, t, p, x, y in serie:
        xs.append(x)
        ys.append(y)
    p = np.poly1d(np.polyfit(xs, ys, 1))
    angle = np.rad2deg(np.arctan(p.c[0]))
    data.append([xs, ys, p, angle])

x = np.arange(2448, dtype=int)

for xs, ys, p, angle in data:
    y = p(x)
    plt.plot(xs, ys, ls='', marker='o', markersize=15, alpha=0.5)
    plt.plot(x, y)

im = plt.imread('./python/calibrate_planes2/test_2000.png')
plt.imshow(im, cmap='gray')
